# ============================================
# Database Configuration
# ============================================

# Event Store (PostgreSQL - port 5436)
DATABASE_URL_EVENTS=postgresql://postgres:postgres@localhost:5436/ticketing_events

# Projections (PostgreSQL - port 5433)
DATABASE_URL_PROJECTIONS=postgresql://postgres:postgres@localhost:5433/ticketing_projections

# Analytics (PostgreSQL - port 5434)
DATABASE_URL_ANALYTICS=postgresql://postgres:postgres@localhost:5434/ticketing_analytics

# Auth (PostgreSQL - port 5435)
DATABASE_URL_AUTH=postgresql://postgres:postgres@localhost:5435/ticketing_auth

# ============================================
# Redis Configuration
# ============================================

# Redis URL
REDIS_URL=redis://localhost:6379

# Redis connection pool size
REDIS_MAX_CONNECTIONS=10

# ============================================
# Event Bus Configuration
# ============================================

# Redpanda brokers
REDPANDA_BROKERS=localhost:9092

# Event Topics
INVENTORY_TOPIC=ticketing-inventory-events
RESERVATION_TOPIC=ticketing-reservation-events
PAYMENT_TOPIC=ticketing-payment-events

# Consumer Group
CONSUMER_GROUP=ticketing-projections

# ============================================
# Server Configuration
# ============================================

# HTTP server host and port
HOST=0.0.0.0
HTTP_PORT=8080

# Log level (trace, debug, info, warn, error)
RUST_LOG=info,ticketing=debug,composable_rust=debug

# ============================================
# WebSocket Configuration
# ============================================

# Max concurrent WebSocket connections (adjust based on available memory)
# With Rust + tokio: 10,000-50,000+ connections feasible on modern hardware
# Memory overhead: ~4-8KB per connection
WS_MAX_CONNECTIONS=50000

# ============================================
# Database Connection Pools
# ============================================

# Event Store pool size (high write volume)
DB_POOL_SIZE_EVENTS=20

# Projections pool size (moderate read volume)
DB_POOL_SIZE_PROJECTIONS=10

# Analytics pool size (batch operations)
DB_POOL_SIZE_ANALYTICS=5

# Auth pool size (session lookups)
DB_POOL_SIZE_AUTH=10

# ============================================
# Authentication Configuration
# ============================================

# Session TTL (seconds) - default: 24 hours
SESSION_TTL=86400

# Magic link token TTL (seconds) - default: 15 minutes
MAGIC_LINK_TTL=900

# WebAuthn challenge TTL (seconds) - default: 5 minutes
WEBAUTHN_CHALLENGE_TTL=300

# Rate limiting: max requests per window
RATE_LIMIT_MAX_REQUESTS=100

# Rate limiting: window duration (seconds) - default: 15 minutes
RATE_LIMIT_WINDOW=900

# ============================================
# Email Configuration (for magic links)
# ============================================

# Email provider: console (logs to stdout) or smtp
EMAIL_PROVIDER=console

# SMTP configuration (if EMAIL_PROVIDER=smtp)
# SMTP_HOST=smtp.example.com
# SMTP_PORT=587
# SMTP_USERNAME=noreply@ticketing.example.com
# SMTP_PASSWORD=<secure-password>
# SMTP_FROM_EMAIL=noreply@ticketing.example.com
# SMTP_FROM_NAME=Ticketing System

# ============================================
# OAuth Configuration (optional)
# ============================================

# GitHub OAuth
# GITHUB_CLIENT_ID=<your-client-id>
# GITHUB_CLIENT_SECRET=<your-client-secret>
# GITHUB_REDIRECT_URI=http://localhost:8080/auth/github/callback

# Google OAuth
# GOOGLE_CLIENT_ID=<your-client-id>
# GOOGLE_CLIENT_SECRET=<your-client-secret>
# GOOGLE_REDIRECT_URI=http://localhost:8080/auth/google/callback

# ============================================
# WebAuthn / Passkey Configuration
# ============================================

# RP (Relying Party) name - displayed to users
WEBAUTHN_RP_NAME=Ticketing System

# RP ID - must match your domain (localhost for development)
WEBAUTHN_RP_ID=localhost

# RP origin - full URL including protocol
WEBAUTHN_RP_ORIGIN=http://localhost:8080

# ============================================
# Observability Configuration
# ============================================

# Enable Prometheus metrics endpoint
METRICS_ENABLED=true

# Enable OpenTelemetry tracing
OTEL_ENABLED=false

# OpenTelemetry endpoint (Jaeger)
# OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317

# ============================================
# Security Configuration
# ============================================

# CORS allowed origins (comma-separated)
CORS_ALLOWED_ORIGINS=http://localhost:5173,http://localhost:8080

# CORS allow credentials
CORS_ALLOW_CREDENTIALS=true

# ============================================
# Development Configuration
# ============================================

# Skip email verification in development (auto-verify magic links)
DEV_SKIP_EMAIL_VERIFICATION=true

# Admin bootstrap
# ADMIN_EMAIL=admin@ticketing.example.com
